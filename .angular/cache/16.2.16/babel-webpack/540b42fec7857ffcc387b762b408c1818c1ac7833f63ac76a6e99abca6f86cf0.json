{"ast":null,"code":"import { FormBuilder, Validators } from '@angular/forms';\nimport { ApiService } from '../services/api.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../services/api.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/material/input\";\nimport * as i5 from \"@angular/material/form-field\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/material/card\";\nimport * as i8 from \"@angular/material/list\";\nimport * as i9 from \"@angular/material/progress-spinner\";\nfunction QueryComponent_div_5_button_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function QueryComponent_div_5_button_9_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const i_r6 = i0.ɵɵnextContext().index;\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.removeRepo(i_r6));\n    });\n    i0.ɵɵtext(1, \"Remove\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction QueryComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15)(1, \"mat-form-field\", 6)(2, \"mat-label\");\n    i0.ɵɵtext(3, \"GitHub URL\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"input\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"mat-form-field\", 6)(6, \"mat-label\");\n    i0.ɵɵtext(7, \"Branch\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(8, \"input\", 17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(9, QueryComponent_div_5_button_9_Template, 2, 0, \"button\", 18);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r6 = ctx.index;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroupName\", i_r6);\n    i0.ɵɵadvance(9);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.repoEntities.length > 1);\n  }\n}\nfunction QueryComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵelement(1, \"mat-spinner\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction QueryComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r2.error);\n  }\n}\nfunction QueryComponent_pre_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"pre\", 22);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"json\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, ctx_r3.response));\n  }\n}\nfunction QueryComponent_mat_list_item_21_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-list-item\", 23);\n    i0.ɵɵlistener(\"click\", function QueryComponent_mat_list_item_21_Template_mat_list_item_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r13);\n      const item_r11 = restoredCtx.$implicit;\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.selectHistory(item_r11));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"slice\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r11 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", item_r11.timestamp, \" \\u2014 \", i0.ɵɵpipeBind3(2, 2, item_r11.payload.query, 0, 60), \"... \");\n  }\n}\nexport let QueryComponent = /*#__PURE__*/(() => {\n  class QueryComponent {\n    constructor(fb, api) {\n      this.fb = fb;\n      this.api = api;\n      this.response = null;\n      this.history = [];\n      this.loading = false;\n      this.error = null;\n    }\n    ngOnInit() {\n      this.queryForm = this.fb.group({\n        repoEntities: this.fb.array([this.fb.group({\n          githubUrl: ['', Validators.required],\n          branch: ['master', Validators.required]\n        })]),\n        query: ['', Validators.required]\n      });\n      this.loadHistory();\n    }\n    get repoEntities() {\n      return this.queryForm.get('repoEntities');\n    }\n    addRepo() {\n      this.repoEntities.push(this.fb.group({\n        githubUrl: ['', Validators.required],\n        branch: ['master', Validators.required]\n      }));\n    }\n    removeRepo(i) {\n      if (this.repoEntities.length > 1) this.repoEntities.removeAt(i);\n    }\n    submit() {\n      if (this.queryForm.invalid) return;\n      this.loading = true;\n      this.error = null;\n      this.response = null;\n      const payload = this.queryForm.value;\n      this.api.runQuery(payload).subscribe({\n        next: res => {\n          this.response = res;\n          this.loading = false;\n          this.saveToHistory(payload, res);\n        },\n        error: err => {\n          this.error = err?.message || 'Request failed';\n          this.loading = false;\n        }\n      });\n    }\n    saveToHistory(payload, response) {\n      const item = {\n        timestamp: new Date().toISOString(),\n        payload,\n        response\n      };\n      this.history.unshift(item);\n      localStorage.setItem('query_history', JSON.stringify(this.history));\n    }\n    loadHistory() {\n      this.history = JSON.parse(localStorage.getItem('query_history') || '[]');\n    }\n    selectHistory(item) {\n      const arr = this.fb.array([]);\n      item.payload.repoEntities.forEach(repo => arr.push(this.fb.group({\n        githubUrl: repo.githubUrl,\n        branch: repo.branch\n      })));\n      this.queryForm.setControl('repoEntities', arr);\n      this.queryForm.patchValue({\n        query: item.payload.query\n      });\n      this.response = item.response;\n    }\n    static {\n      this.ɵfac = function QueryComponent_Factory(t) {\n        return new (t || QueryComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.ApiService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: QueryComponent,\n        selectors: [[\"app-query\"]],\n        decls: 22,\n        vars: 7,\n        consts: [[1, \"max-w-3xl\"], [1, \"text-xl\", \"font-semibold\", \"mb-4\"], [1, \"space-y-4\", 3, \"formGroup\", \"ngSubmit\"], [\"formArrayName\", \"repoEntities\"], [\"class\", \"mb-4 p-4 bg-white rounded shadow-sm\", 3, \"formGroupName\", 4, \"ngFor\", \"ngForOf\"], [\"mat-button\", \"\", \"color\", \"primary\", 3, \"click\"], [1, \"w-full\"], [\"matInput\", \"\", \"rows\", \"4\", \"formControlName\", \"query\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"type\", \"submit\", 3, \"disabled\"], [\"class\", \"mt-4 flex justify-center\", 4, \"ngIf\"], [\"class\", \"mt-4 text-red-600\", 4, \"ngIf\"], [\"class\", \"bg-gray-100 p-4 rounded mt-4\", 4, \"ngIf\"], [1, \"mt-6\", \"max-w-3xl\"], [1, \"text-lg\", \"font-semibold\"], [\"style\", \"cursor: pointer;\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"mb-4\", \"p-4\", \"bg-white\", \"rounded\", \"shadow-sm\", 3, \"formGroupName\"], [\"matInput\", \"\", \"formControlName\", \"githubUrl\", \"placeholder\", \"https://github.com/owner/repo\"], [\"matInput\", \"\", \"formControlName\", \"branch\"], [\"mat-button\", \"\", \"color\", \"warn\", 3, \"click\", 4, \"ngIf\"], [\"mat-button\", \"\", \"color\", \"warn\", 3, \"click\"], [1, \"mt-4\", \"flex\", \"justify-center\"], [1, \"mt-4\", \"text-red-600\"], [1, \"bg-gray-100\", \"p-4\", \"rounded\", \"mt-4\"], [2, \"cursor\", \"pointer\", 3, \"click\"]],\n        template: function QueryComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"mat-card\", 0)(1, \"h2\", 1);\n            i0.ɵɵtext(2, \"Run Query Against Repositories\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(3, \"form\", 2);\n            i0.ɵɵlistener(\"ngSubmit\", function QueryComponent_Template_form_ngSubmit_3_listener() {\n              return ctx.submit();\n            });\n            i0.ɵɵelementStart(4, \"div\", 3);\n            i0.ɵɵtemplate(5, QueryComponent_div_5_Template, 10, 2, \"div\", 4);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(6, \"button\", 5);\n            i0.ɵɵlistener(\"click\", function QueryComponent_Template_button_click_6_listener() {\n              return ctx.addRepo();\n            });\n            i0.ɵɵtext(7, \"+ Add Repository\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"mat-form-field\", 6)(9, \"mat-label\");\n            i0.ɵɵtext(10, \"Query\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(11, \"textarea\", 7);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(12, \"button\", 8);\n            i0.ɵɵtext(13, \"Run Query\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(14, QueryComponent_div_14_Template, 2, 0, \"div\", 9);\n            i0.ɵɵtemplate(15, QueryComponent_div_15_Template, 2, 1, \"div\", 10);\n            i0.ɵɵtemplate(16, QueryComponent_pre_16_Template, 3, 3, \"pre\", 11);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(17, \"mat-card\", 12)(18, \"h3\", 13);\n            i0.ɵɵtext(19, \"Query History\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(20, \"mat-list\");\n            i0.ɵɵtemplate(21, QueryComponent_mat_list_item_21_Template, 3, 6, \"mat-list-item\", 14);\n            i0.ɵɵelementEnd()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"formGroup\", ctx.queryForm);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngForOf\", ctx.repoEntities.controls);\n            i0.ɵɵadvance(7);\n            i0.ɵɵproperty(\"disabled\", ctx.loading);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngIf\", ctx.loading);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", ctx.error);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", ctx.response);\n            i0.ɵɵadvance(5);\n            i0.ɵɵproperty(\"ngForOf\", ctx.history);\n          }\n        },\n        dependencies: [i3.NgForOf, i3.NgIf, i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, i1.FormGroupName, i1.FormArrayName, i4.MatInput, i5.MatFormField, i5.MatLabel, i6.MatButton, i7.MatCard, i8.MatList, i8.MatListItem, i9.MatProgressSpinner, i3.JsonPipe, i3.SlicePipe]\n      });\n    }\n  }\n  return QueryComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}